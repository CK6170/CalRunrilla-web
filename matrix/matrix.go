// ...existing code from matrix.go...
